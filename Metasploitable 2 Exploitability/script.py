# To add a new cell, type '# %%'
# To add a new markdown cell, type '# %% [markdown]'
# %%
import json

# %%

with open('report.json') as f:
    data = json.load(f)

data = data['site']


# %%
for x in range(0,len(data)):
    if("192" in data[x]['@name']):
        site=data[x]        


# %%
filtered=[]

def extractit(site_data):
    site_data=site_data['alerts']
    for alert in site_data:
        filtered.append([alert['name'],alert['riskdesc'],[[t['method'],t['uri']] for t in alert['instances']]])


extractit(site)


# %%
with open('results.txt','a+') as txtfile:
    for item in filtered:
        txtfile.write(f"Alert Name : {item[0]} , Alert Rating :  {item[1]}\n")
        txtfile.write(f"\n")
        for vpages in item[2]:
            txtfile.write(f"{vpages[0]} --> {vpages[1]}\n")
        txtfile.write("\n\n"+"#"*10+"\n")


# %%



